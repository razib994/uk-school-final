!function(e){e.fn.uploader=function(i){var a={get_random_integer:function(e,i){return Math.floor(Math.random()*(i-e+1))+e},bytes_to_size:function(e){var i=["Bytes","KB","MB","GB","TB"];if(0==e)return"0 Byte";var a=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,a),2)+" "+i[a]}},t=function(){var e=0;return function(i,a){clearTimeout(e),e=setTimeout(i,a)}}(),r=e.ajaxSettings.xhr;e.ajaxSetup({progress:e.noop,xhr:function(){var e=r(),i=this;return e.upload.addEventListener("progress",function(e){void 0!==i.progress&&i.progress(e)},!1),e}});var l=e(this),n=a.get_random_integer(1,1999199919991),o=e.extend({upload_url:"",input_name:"",auto_upload:!0,maximum_total_files:null,maximum_file_size:null,file_types_allowed:null,file_picker_url:"",files_per_page:24,on_error:function(e){},on_before_upload:function(){},on_after_upload:function(){}},i),p={input_file:"uploaderfile-"+n,input_text:"uploadertext-"+n,wrapper:"uploaderwrapper-"+n,temporary_files:[],generate_elements:function(){e(l).parent().append('<input type="file" id="'+p.input_file+'" style="display: none;" multiple>'),e(l).parent().append('<input type="text" name="'+o.input_name+'" id="'+p.input_text+'" value="[]" style="display: none;">'),e(l).parent().append('<div class="uploaderwrapper" id="'+p.wrapper+'"></div>'),p.uploader_trigger(),p.on_change()},uploader_trigger:function(){e(l).on("click",function(){e("#"+p.input_file).val(""),e("#"+p.input_file).click()})},validate_maximum_total_files:function(e,i){return null!==o.maximum_total_files&&e+i>o.maximum_total_files?(o.on_error({status:"error_maximum_total_files",messages:"Number of files to be uploaded is "+o.maximum_total_files}),!1):!0},validate_maximum_file_size:function(e){if(null!==o.maximum_file_size){for(var i=[],a=0;a<e.length;a++)e[a].size>o.maximum_file_size&&i.push(e[a].name);return i.length>0?(o.on_error({status:"error_maximum_file_size",messages:i}),!1):!0}return!0},validate_file_type:function(e){if(null!==o.file_types_allowed){for(var i=[],a=0;a<e.length;a++)-1==o.file_types_allowed.indexOf(e[a].type)&&i.push(e[a].name);return i.length>0?(o.on_error({status:"error_file_type",messages:i}),!1):!0}return!0},uploader_template:function(i,t){var r='<div class="uploaderbox" data-file-name="'+i.name+'"><div class="uploaderbox-image"></div><div class="uploaderbox-text">'+i.name.toLowerCase()+'</div><div class="uploaderbox-filesize">'+a.bytes_to_size(i.size)+'</div><div class="uploaderbox-progressbar"><div class="uploaderbox-fill"></div></div><div class="uploaderbox-close">&times;</div></div>';return r=e(r),void 0!==i.type&&-1!==["png","jpg","jpeg"].indexOf(i.type.split("/")[1])?e(r).find(".uploaderbox-image").css({"background-image":"url("+t.target.result+")"}):e(r).find(".uploaderbox-image").css({background:"rgb(119, 119, 119)",background:"-webkit-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"-o-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"-moz-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))"}),r},on_remove:function(i){e(i).find(".uploaderbox-close").on("click",function(){e(this).off();for(var i=e(this).parent().attr("data-file-name"),a=JSON.parse(e("#"+p.input_text).val()),t=!1,r=0;r<a.length;r++)a[r].file_name==i&&(t=r);if(a.splice(t,1),e("#"+p.input_text).val(JSON.stringify(a)),!o.auto_upload){for(var t=!1,l=0;l<p.temporary_files.length;l++)p.temporary_files[l].file_reader.name==i&&(t=l);p.temporary_files.splice(t,1)}e(this).parent().fadeOut(function(){e(this).remove()}),e(document).unbind("mousemove")})},upload:function(i,t,r){var l=new FormData;l.append("file",t),e.ajax({url:o.upload_url,data:l,processData:!1,contentType:!1,type:"POST",success:function(l){var l=JSON.parse(l),n=setInterval(function(){var o=parseInt(100*e(i).find(".uploaderbox-fill").width())/parseInt(e(i).find(".uploaderbox-progressbar").width());100>o?(e(i).attr("data-file-name",l.file_name),e(i).find(".uploaderbox-fill").css("width",(o+=1)+"%"),e(i).find(".uploaderbox-filesize").html(Math.ceil(o)+"%")):(clearInterval(n),e(i).find(".uploaderbox-filesize").html(a.bytes_to_size(t.size)),e(i).find(".uploaderbox-progressbar").fadeOut(),r(l))},100)},progress:function(a){a.lengthComputable?(e(i).find(".uploaderbox-filesize").html(parseInt(a.loaded/a.total*100,10)-30+"%"),e(i).find(".uploaderbox-fill").css("width",parseInt(a.loaded/a.total*100,10)-30+"%")):console.log("Length not computable.")}})},on_change:function(){e("#"+p.input_file).change(function(){var i=e("#"+p.input_file)[0].files,a=(e("#"+p.input_text).val(),p.validate_maximum_total_files(e("#"+p.wrapper).find(".uploaderbox").length,i.length)),t=p.validate_maximum_file_size(i),r=p.validate_file_type(i);if(a&&t&&r){o.auto_upload&&o.on_before_upload();for(var l=0;l<i.length;l++){var n=new FileReader;n.onload=function(i,a){return function(a){var t=p.uploader_template(i,a);p.on_remove(t),e("#"+p.wrapper).append(t),o.auto_upload?p.upload(t,i,function(i){if(""!==e("#"+p.input_text).val()){var a=JSON.parse(e("#"+p.input_text).val());a.push(i),e("#"+p.input_text).val(JSON.stringify(a))}else e("#"+p.input_text).val(JSON.stringify([i]));p.save_sort()}):p.temporary_files.push({template:t,file_reader:i}),p.sort_files()}}(i[l],l),n.readAsDataURL(i[l])}}var s=!1;e(document).off(),e(document).ajaxStop(function(){s||(s=!0,setTimeout(function(){o.on_success_upload()},2e3))})})},manual_upload:function(i){if(o.on_before_upload(),p.temporary_files.length>0){for(var a=0,t=0;t<p.temporary_files.length;t++)p.upload(p.temporary_files[t].template,p.temporary_files[t].file_reader,function(i){if(""!==e("#"+p.input_text).val()){var t=JSON.parse(e("#"+p.input_text).val());t.push(i),e("#"+p.input_text).val(JSON.stringify(t))}else e("#"+p.input_text).val(JSON.stringify([i]));p.save_sort(),a++});e(document).ajaxStop(function(){var e=setInterval(function(){a==p.temporary_files.length&&(p.temporary_files=[],i(),clearInterval(e))},1e3)})}else i()},sort_files:function(){e("#"+p.wrapper).find(".uploaderbox").each(function(){var i,a,t=this,r=e('<div class="uploaderbox-placeholder"><div class="uploaderbox-image"></div></div>'),l=null,n=null;e(t).off(),e(t).mousedown(function(){e(document).mousemove(function(o){null==n&&(l=o.pageX-e(t).position().left,n=o.pageY-e(t).position().top),e(t).css({cursor:"move","z-index":"9999999",position:"absolute",top:o.pageY-n+"px",left:o.pageX-l+"px","-webkit-animation":"initial",animation:"initial"}),e("#"+p.wrapper).find(".placeholder").remove(),e(t).after(r),a=e(r).position().top,i=e(r).position().left,e("#"+p.wrapper).find(".uploaderbox").each(function(){if(this!==t){var s=e(this).position();o.pageX-l>=s.left&&o.pageX-l<=s.left+e(this).width()&&o.pageY-n>=s.top&&o.pageY-n<=s.top+e(this).height()&&(e("#"+p.wrapper).find(".placeholder").remove(),o.pageX-l>=s.left&&o.pageX-l<=s.left+50*e(this).width()/100?e(this).before(r):o.pageX-l>=s.left+50*e(this).width()/100&&o.pageX-l<=s.left+e(this).width()&&e(this).after(r),e(r).before(t),a=e(r).position().top,i=e(r).position().left)}})})}).mouseup(function(){1==e(document).find(r).length&&(e(document).unbind("mousemove"),e(t).animate({position:"absolute",top:a+"px",left:i+"px"},100,function(){e(t).css({position:"relative","z-index":"99999",top:"auto",left:"auto",cursor:"pointer"}),e(r).replaceWith(t),p.save_sort(),l=null,n=null}))})})},save_sort:function(){var i=JSON.parse(e("#"+p.input_text).val()),a=[];e("#"+p.wrapper).find(".uploaderbox").each(function(){for(var t=0;t<i.length;t++)i[t].file_name==e(this).attr("data-file-name")&&a.push(i[t])}),e("#"+p.input_text).val(JSON.stringify(a))}};this.upload=function(e){p.manual_upload(e)};var s={input_file:"uploaderfile-"+n,input_text:"uploadertext-"+n,wrapper:"uploaderwrapper-"+n,picker:"pickerwrapper-"+n,temporary_files:[],filepicker_template:function(){var i='<div class="pickerwrapper" id="'+s.picker+'"><div class="pickerclose">&times;</div><div class="pickerbox"><div class="pickermenu"><ul><li data-menu="files" class="active">Files</li><li data-menu="upload">Upload</li></ul></div><div class="pickermain"><div class="pickercontent"><div class="pickertoolbar"><input type="text" class="pickersearch" placeholder="Search files..."><div class="pickerview"><div class="pickericon-wrapper picker-thumbnail active" data-view="thumbnail"><div class="pickericon-box"><div class="pickericon"></div><div class="pickericon"></div><div class="pickericon"></div><div class="pickericon"></div></div></div><div class="pickericon-wrapper picker-grid" data-view="grid"><div class="pickericon-box"><div class="pickericon"></div><div class="pickericon"></div><div class="pickericon"></div><div class="pickericon"></div></div></div></div><div class="pickerinfo"><span class="pickerselectedfiles">0</span> Files selected of '+o.maximum_total_files+' maximum allowed <a class="pickerclear" href="javascript:;">Clear</a></div></div><div class="pickerfiles"></div><div class="pickerbottom"><div class="pickerpagination"><ul></ul></div><div class="pickeraction"><button type="button" class="pickersave">Save</button></div></div></div><div class="pickerupload"><div class="pickerupload-alert">The file has been successfully uploaded and selected</div><div class="pickerupload-left"><div class="pickerupload-text">Use the button bellow to upload some files</div><button type="button" class="pickerupload-button">Choose Files</button><div class="pickerupload-maximum">Maximum upload file size: '+a.bytes_to_size(o.maximum_file_size)+'.</div></div><div class="pickerupload-right"><div class="pickerupload-notfound">No upload process</div></div></div></div></div></div>';return i=e(i),null===o.maximum_file_size&&e(i).find(".pickerupload-maximum").hide(),e(i).find(".pickersearch").on("keyup",function(){t(function(){s.load_files(1)},1e3)}),e(i).find(".pickermenu > ul > li").on("click",function(){var a=e(this).attr("data-menu");"files"==a?(e(i).find(".pickermenu > ul > li").removeClass("active"),e(this).addClass("active"),e(i).find(".pickercontent").animate({marginTop:"0px"})):(e(i).find(".pickermenu > ul > li").removeClass("active"),e(this).addClass("active"),e(i).find(".pickercontent").animate({marginTop:"-"+e(i).find(".pickercontent").height()+"px"}))}),e(i).find(".pickericon-wrapper").on("click",function(){var a=e(this).attr("data-view");e(".pickericon-wrapper").removeClass("active"),e(this).addClass("active"),e(i).find(".pickerfiles").addClass("pickerloading"),setTimeout(function(){e(i).find(".pickerfiles").removeClass("pickerloading"),"thumbnail"==a?e(i).find(".pickerfiles").removeClass("pickerlist"):e(i).find(".pickerfiles").addClass("pickerlist")},500)}),e(i).find(".pickerclose").on("click",function(){e(i).hide(),e(i).find(".pickerfiles").html(""),e(i).find(".pickerpagination > ul").html(""),s.temporary_files=[]}),s.save_filepicker(i),i},sort_files:function(){e("#"+s.wrapper).find(".uploaderbox").each(function(){var i,a,t=this,r=e('<div class="uploaderbox-placeholder"><div class="uploaderbox-image"></div></div>'),l=null,n=null;e(t).off(),e(t).mousedown(function(){e(document).mousemove(function(o){null==n&&(l=o.pageX-e(t).position().left,n=o.pageY-e(t).position().top),e(t).css({cursor:"move","z-index":"9999999",position:"absolute",top:o.pageY-n+"px",left:o.pageX-l+"px","-webkit-animation":"initial",animation:"initial"}),e("#"+s.wrapper).find(".placeholder").remove(),e(t).after(r),a=e(r).position().top,i=e(r).position().left,e("#"+s.wrapper).find(".uploaderbox").each(function(){if(this!==t){var p=e(this).position();o.pageX-l>=p.left&&o.pageX-l<=p.left+e(this).width()&&o.pageY-n>=p.top&&o.pageY-n<=p.top+e(this).height()&&(e("#"+s.wrapper).find(".placeholder").remove(),o.pageX-l>=p.left&&o.pageX-l<=p.left+50*e(this).width()/100?e(this).before(r):o.pageX-l>=p.left+50*e(this).width()/100&&o.pageX-l<=p.left+e(this).width()&&e(this).after(r),e(r).before(t),a=e(r).position().top,i=e(r).position().left)}})})}).mouseup(function(){1==e(document).find(r).length&&(e(document).unbind("mousemove"),e(t).animate({position:"absolute",top:a+"px",left:i+"px"},100,function(){e(t).css({position:"relative","z-index":"99999",top:"auto",left:"auto",cursor:"pointer"}),e(r).replaceWith(t),s.save_sort(),l=null,n=null}))})})},save_sort:function(){var i=JSON.parse(e("#"+s.input_text).val()),a=[];e("#"+s.wrapper).find(".uploaderbox").each(function(){for(var t=0;t<i.length;t++)i[t].file_name==e(this).attr("data-file-name")&&a.push(i[t])}),e("#"+s.input_text).val(JSON.stringify(a))},uploader_template:function(i){var t='<div class="uploaderbox" data-file-name=\''+i.file_name+'\'><div class="uploaderbox-image"><div class="uploaderbox-background"></div><div class="uploaderbox-overlay"></div></div><div class="uploaderbox-text">'+i.file_name+'</div><div class="uploaderbox-filesize">'+a.bytes_to_size(i.file_size)+'</div><div class="uploaderbox-close">&times;</div></div>';if(t=e(t),""!=i.file_thumbnail){var r=e("<img>");r.load(function(){var i=e(this);setTimeout(function(){e(t).find(".uploaderbox-background").css({"background-image":"url("+e(i).attr("src")+")"}).fadeIn("slow"),e(t).find(".uploaderbox-overlay").css("margin-top","-100%").fadeOut("slow")},1e3)}),r.attr("src",i.file_thumbnail.split(" ").join("%20"))}else e(t).find(".uploaderbox-image").css({background:"rgb(119, 119, 119)",background:"-webkit-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"-o-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"-moz-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))"});return e(t).find(".uploaderbox-close").on("click",function(){e(this).off();for(var i=e(this).parent().attr("data-file-name"),a=JSON.parse(e("#"+s.input_text).val()),t=!1,r=0;r<a.length;r++)a[r].file_name==i&&(t=r);a.splice(t,1),e("#"+s.input_text).val(JSON.stringify(a)),e(this).parent().fadeOut(function(){e(this).remove()}),e(document).unbind("mousemove")}),t},save_filepicker:function(i){e(i).find(".pickersave").on("click",function(){e(i).hide(),e(i).find(".pickerfiles").html(""),e(i).find(".pickerpagination > ul").html(""),e("#"+s.input_text).val(JSON.stringify(s.temporary_files)),e("#"+s.wrapper).html("");for(var a=0;a<s.temporary_files.length;a++){var t=s.uploader_template(s.temporary_files[a]);e("#"+s.wrapper).append(t)}s.sort_files(),s.temporary_files=[]})},validate_upload_maximum_file_size:function(e){if(null!==o.maximum_file_size){for(var i=[],a=0;a<e.length;a++)e[a].size>o.maximum_file_size&&i.push(e[a].name);return i.length>0?(o.on_error({status:"error_maximum_file_size",messages:i}),!1):!0}return!0},validate_upload_file_type:function(e){if(null!==o.file_types_allowed){for(var i=[],a=0;a<e.length;a++)-1==o.file_types_allowed.indexOf(e[a].type)&&i.push(e[a].name);return i.length>0?(o.on_error({status:"error_file_type",messages:i}),!1):!0}return!0},upload_progress_template:function(i,t){var r='<div class="uploaderbox"><div class="uploaderbox-image"></div><div class="uploaderbox-text">'+i.name.toLowerCase()+'</div><div class="uploaderbox-filesize">'+a.bytes_to_size(i.size)+'</div><div class="uploaderbox-progressbar"><div class="uploaderbox-fill"></div></div></div>';return r=e(r),void 0!==i.type&&-1!==["png","jpg","jpeg"].indexOf(i.type.split("/")[1])?e(r).find(".uploaderbox-image").css({"background-image":"url("+t.target.result+")"}):e(r).find(".uploaderbox-image").css({background:"rgb(119, 119, 119)",background:"-webkit-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"-o-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"-moz-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))"}),r},upload:function(i,t,r){var l=new FormData;l.append("file",t),e.ajax({url:o.upload_url,data:l,processData:!1,contentType:!1,type:"POST",success:function(l){var l=JSON.parse(l);r(l);var n=setInterval(function(){var r=parseInt(100*e(i).find(".uploaderbox-fill").width())/parseInt(e(i).find(".uploaderbox-progressbar").width());100>r?(e(i).attr("data-file-name",l.file_name),e(i).find(".uploaderbox-fill").css("width",(r+=1)+"%"),e(i).find(".uploaderbox-filesize").html(Math.ceil(r)+"%")):(clearInterval(n),e(i).find(".uploaderbox-filesize").html(a.bytes_to_size(t.size)),e(i).find(".uploaderbox-progressbar").fadeOut(),e(i).fadeOut().remove())},100)},progress:function(a){a.lengthComputable?(e(i).find(".uploaderbox-filesize").html(parseInt(a.loaded/a.total*100,10)-30+"%"),e(i).find(".uploaderbox-fill").css("width",parseInt(a.loaded/a.total*100,10)-30+"%")):console.log("Length not computable.")}})},on_change:function(){e("#"+s.input_file).change(function(){var i=e("#"+p.input_file)[0].files,a=s.validate_upload_maximum_file_size(i),t=s.validate_upload_file_type(i);if(a&&t){e("#"+s.picker).find(".pickerupload-notfound").fadeOut();for(var r=0;r<i.length;r++){var l=new FileReader;l.onload=function(i,a){return function(a){var t=s.upload_progress_template(i,a);e("#"+s.picker).find(".pickerupload-right").prepend(t),s.upload(t,i,function(i){s.temporary_files.length+1>o.maximum_total_files?(s.temporary_files.splice(0,1),s.temporary_files.push(i)):s.temporary_files.push(i),e("#"+s.picker).find(".pickersave").attr("disabled",!1)})}}(i[r],r),l.readAsDataURL(i[r])}}var n=!1;e(document).ajaxStop(function(){n||(n=!0,s.load_files(1),setTimeout(function(){e("#"+s.picker).find(".pickerupload-alert").animate({top:"30px"}),setTimeout(function(){e("#"+s.picker).find(".pickerupload-alert").animate({top:"-60px"})},5e3),e("#"+s.picker).find(".pickerupload-notfound").fadeIn()},2e3))})})},upload_trigger:function(){e("#"+s.picker).find(".pickerupload-button").on("click",function(){e("#"+s.input_file).val(""),e("#"+s.input_file).click()})},generate_elements:function(){e(l).parent().append('<input type="file" id="'+s.input_file+'" style="display: none;" multiple>'),e(l).parent().append('<input type="text" name="'+o.input_name+'" id="'+s.input_text+'" value="[]" style="display: none;">'),e(l).parent().append('<div class="uploaderwrapper" id="'+s.wrapper+'"></div>'),e("body").append(s.filepicker_template()),s.filepicker_trigger(),s.upload_trigger(),s.on_change(),s.clear_selected_files()},validate_maximum_file_size:function(e){return null!==o.maximum_file_size&&e.file_size>o.maximum_file_size?(o.on_error({status:"error_maximum_file_size",messages:[e.file_name]}),!1):!0},validate_file_type:function(e){return null!==o.file_types_allowed&&-1==o.file_types_allowed.indexOf(e.file_type)?(o.on_error({status:"error_file_type",messages:[e.file_name]}),!1):!0},on_click:function(i){e(i).on("click",function(){var i=JSON.parse(e(this).attr("data-file")),a=s.validate_maximum_file_size(i),t=s.validate_file_type(i);if(a&&t){e(this).addClass("selected"),e(this).find(".uploaderbox-close").show();for(var r=!1,l=0;l<s.temporary_files.length;l++)s.temporary_files[l].file_name==i.file_name&&(r=!0);if(!r){if(null!==o.maximum_total_files&&s.temporary_files.length+1>o.maximum_total_files){var n=s.temporary_files[0].file_name;s.temporary_files.splice(0,1),e("#"+s.picker).find(".pickerfiles").find(".uploaderbox").each(function(){var i=JSON.parse(e(this).attr("data-file")).file_name;n==i&&(e(this).removeClass("selected"),e(this).find(".uploaderbox-close").hide())})}s.temporary_files.push(i),e("#"+s.picker).find(".pickersave").attr("disabled",!1),e("#"+s.picker).find(".pickerselectedfiles").html(s.temporary_files.length),e("#"+s.picker).find(".pickerclear").show()}}})},on_remove:function(i){e(i).find(".uploaderbox-close").on("click",function(i){e(this).parent().removeClass("selected"),e(this).hide();for(var a=JSON.parse(e(this).parent().attr("data-file")),t=0;t<s.temporary_files.length;t++)s.temporary_files[t].file_name==a.file_name&&s.temporary_files.splice(t,1);0==s.temporary_files.length&&e("#"+s.picker).find(".pickersave").attr("disabled",!0),e("#"+s.picker).find(".pickerselectedfiles").html(s.temporary_files.length),s.temporary_files.length>0?e("#"+s.picker).find(".pickerclear").show():"",i.stopPropagation()})},pagination:function(i,a){var t=Math.ceil(i.total/o.files_per_page);e("#"+s.picker).find(".pickerpagination > ul").html("");var r=e("<li>First</li>");a>1&&e(r).on("click",function(){s.load_files(1)}),e("#"+s.picker).find(".pickerpagination > ul").append(r);var l=e("<li>Prev</li>");a>1&&e(l).on("click",function(){s.load_files(a-1)}),e("#"+s.picker).find(".pickerpagination > ul").append(l);var n;if(0>=a-3)n=1;else{var p=0;if(a+3>t){var d=a+3-t;p=a-3-d>0?d:a-1-3}else p=0;n=a-3-p}for(var f=n;a>f;f++){var c=e('<li data-page="'+f+'">'+f+"</li>");e(c).on("click",function(){s.load_files(e(this).attr("data-page"))}),e("#"+s.picker).find(".pickerpagination > ul").append(c)}e("#"+s.picker).find(".pickerpagination > ul").append('<li class="active">'+a+"</li>");var u;if(a+3>t)u=t;else{var p=0;if(0>=a-3){var d=3-(a-1);p=a+3+d>t?t-a-3:d}else p=0;u=a+3+p}for(var f=a+1;u>=f;f++){var c=e('<li data-page="'+f+'">'+f+"</li>");e(c).on("click",function(){s.load_files(e(this).attr("data-page"))}),e("#"+s.picker).find(".pickerpagination > ul").append(c)}var m=e("<li>Next</li>");t>a&&e(m).on("click",function(){s.load_files(a+1)}),e("#"+s.picker).find(".pickerpagination > ul").append(m);var _=e("<li>Last</li>");t>a&&e(_).on("click",function(){s.load_files(t)}),e("#"+s.picker).find(".pickerpagination > ul").append(_)},clear_selected_files:function(){e("#"+s.picker).find(".pickerclear").hide(),e("#"+s.picker).find(".pickerclear").on("click",function(){s.temporary_files=[],e("#"+s.picker).find(".pickerselectedfiles").html(s.temporary_files.length),e("#"+s.picker).find(".pickerclear").hide(),e("#"+s.picker).find(".pickerfiles").find(".uploaderbox").each(function(){e(this).removeClass("selected"),e(this).find(".uploaderbox-close").hide()})})},filepicker_box_template:function(i){for(var t=!1,r=0;r<s.temporary_files.length;r++)s.temporary_files[r].file_name==i.file_name&&(t=!0);var l=t?"selected":"",n='<div class="uploaderbox '+l+"\" data-file='"+JSON.stringify(i)+'\'><div class="uploaderbox-image"><div class="uploaderbox-background"></div><div class="uploaderbox-overlay"></div></div><div class="uploaderbox-text"><div class="uploaderbox-textfill">'+i.file_name+'</div></div><div class="uploaderbox-filesize">'+a.bytes_to_size(i.file_size)+'</div><div class="uploaderbox-close">&times;</div></div>';if(n=e(n),t?"":e(n).find(".uploaderbox-close").hide(),""!=i.file_thumbnail){var o=e("<img>");o.load(function(){var i=e(this);setTimeout(function(){e(n).find(".uploaderbox-background").css({"background-image":"url("+e(i).attr("src")+")"}).fadeIn("slow"),e(n).find(".uploaderbox-overlay").css("margin-top","-100%").fadeOut("slow")},1e3)}),o.attr("src",i.file_thumbnail.split(" ").join("%20"))}else e(n).find(".uploaderbox-image").css({background:"rgb(119, 119, 119)",background:"-webkit-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"-o-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"-moz-linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))",background:"linear-gradient(rgb(119, 119, 119), rgb(0, 0, 0))"}),e(n).find(".uploaderbox-overlay").hide();return n},load_files:function(i){i=parseInt(i),e("#"+s.picker).find(".pickerfiles").scrollTop(0),e("#"+s.picker).find(".pickerfiles").addClass("pickerloading"),e.get(o.file_picker_url,{page:i,files_per_page:o.files_per_page,search_file:e("#"+s.picker).find(".pickersearch").val()}).done(function(a){var a=JSON.parse(a);e("#"+s.picker).find(".pickerfiles").removeClass("pickerloading").html("");for(var t=0;t<a.files.length;t++){var r=s.filepicker_box_template(a.files[t]);s.on_click(r),s.on_remove(r),e("#"+s.picker).find(".pickerfiles").append(r)}e("#"+s.picker).find(".pickerselectedfiles").html(s.temporary_files.length),s.temporary_files.length>0?e("#"+s.picker).find(".pickerclear").show():"",s.pagination(a,i)})},filepicker_trigger:function(){e(l).on("click",function(){s.temporary_files=JSON.parse(e("#"+s.input_text).val()),0==s.temporary_files.length?e("#"+s.picker).find(".pickersave").attr("disabled",!0):e("#"+s.picker).find(".pickersave").attr("disabled",!1),e("#"+s.picker).show(),s.load_files(1)})}};return""==o.file_picker_url?p.generate_elements():s.generate_elements(),this.set_files=function(i){var a=JSON.parse(i),t=""==o.file_picker_url?p:s;e("#"+s.input_text).val(JSON.stringify(a));for(var r=0;r<a.length;r++){var l=s.uploader_template(a[r]);e("#"+t.wrapper).append(l)}t.sort_files()},this}}(jQuery);